@model List<EduAdmissionSite.Models.Article>
@using EduAdmissionSite.Models

@{
    ViewData["Title"] = "VIDEO";
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIDEO</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        :root {
            --primary-color: rgb(46, 58, 135);
            --secondary-color: #EC6C41;
        }

        .breadcrumb-section { background-color: #e3f2fd; padding: 1rem 0; }
        .breadcrumb { background-color: transparent; padding: 0; margin-bottom: 0; }
        .breadcrumb a { color: var(--primary-color); text-decoration: none; font-weight: 500; }
        .breadcrumb .active { color: var(--primary-color); font-weight: 600; }

        .video-page-section { padding: 20px 0; }
        .video-page-header { margin-bottom: 30px; }
        .video-page-title { font-size: 24px; font-weight: bold; color: #333; display: flex; align-items: center; gap: 10px; }
        .video-page-title-icon { 
            display: inline-flex; 
            align-items: center; 
            justify-content: center; 
            width: 36px; 
            height: 36px; 
            border-radius: 50%; 
            background: var(--primary-color); 
            color: #fff; 
            font-size: 18px; 
        }

        .video-page-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 40px; }
        @@media (max-width: 1200px) { .video-page-grid { grid-template-columns: repeat(3, 1fr); } }
        @@media (max-width: 768px)  { .video-page-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; } }
        @@media (max-width: 480px)  { .video-page-grid { grid-template-columns: 1fr; } }

        .video-page-card { background: white; border-radius: 8px; overflow: hidden; transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .video-page-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }

        .video-page-image-container { position: relative; width: 100%; height: 200px; overflow: hidden; }
        .video-page-thumbnail { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease; }
        .video-page-card:hover .video-page-thumbnail { transform: scale(1.05); }

        .video-page-hover-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.4); display: flex; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s ease; }
        .video-page-card:hover .video-page-hover-overlay { opacity: 1; }

        .video-page-play-button { 
            width: 80px; 
            height: 80px; 
            background: var(--secondary-color); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-size: 2rem; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            border: 3px solid rgba(255,255,255,0.3);
        }
        .video-page-play-button:hover { 
            transform: scale(1.1); 
            background: #c0392b; 
            border-color: rgba(255,255,255,0.5); 
        }

        .video-page-article-title { padding: 15px; font-size: 14px; line-height: 1.4; color: #333; margin: 0; font-weight: 500; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }

        /* Pagination styles aligned with Images Index */
        .pagination { justify-content: center; margin-top: 2rem; }
        .page-link { color: white; background-color: var(--primary-color); border: 1px solid var(--primary-color); border-radius: 0; padding: 0.5rem 0.75rem; margin: 0 2px; min-width: 40px; text-align: center; }
        .page-item.active .page-link { background-color: var(--primary-color); border-color: var(--primary-color); color: white; }
        .page-link:hover { background-color: var(--secondary-color); border-color: var(--secondary-color); color: white; }
        .page-item.disabled .page-link { background-color: #ccc; border-color: #ccc; color: #666; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <div class="container-fluid breadcrumb-section">
        <div class="container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/">TRANG CHỦ</a></li>
                    <li class="breadcrumb-item active" aria-current="page">VIDEO</li>
                </ol>
            </nav>
        </div>
    </div>

    <div class="container video-page-section">
        <div class="row">
            <!-- Main -->
            <div class="col-lg-8">
                <div class="video-page-header">
                    <h2 class="video-page-title"><span class="video-page-title-icon"><i class="bi bi-camera-video-fill"></i></span>VIDEO</h2>
                </div>

                <div class="video-page-grid">
                    @foreach (var article in Model.Where(a => (a.Category & ArticleCategory.Video) != 0))
                    {
                        <div class="video-page-card">
                            <div class="video-page-image-container">
                                <img src="@article.ThumbnailUrl" alt="@article.Title" class="video-page-thumbnail" />
                                <div class="video-page-hover-overlay">
                                    <div class="video-page-play-button" onclick="playVideo('@article.VideoUrl')">
                                        <i class="bi bi-play-fill"></i>
                                    </div>
                                </div>
                            </div>
                            <h3 class="video-page-article-title">@article.Title</h3>
                        </div>
                    }
                </div>

                <!-- Pagination (Bootstrap style like Images Index) -->
                <nav aria-label="Page navigation">
                    <ul class="pagination">
                        @if ((int)(ViewBag.CurrentPage ?? 1) > 1)
                        {
                            <li class="page-item">
                                <a class="page-link" href="?page=@(ViewBag.CurrentPage - 1)" aria-label="Previous">
                                    <i class="bi bi-chevron-double-left"></i>
                                </a>
                            </li>
                        }
                        else
                        {
                            <li class="page-item disabled">
                                <span class="page-link" aria-label="Previous">
                                    <i class="bi bi-chevron-double-left"></i>
                                </span>
                            </li>
                        }

                        @for (int i = Math.Max(1, (int)(ViewBag.CurrentPage ?? 1) - 2); i <= Math.Min((int)(ViewBag.TotalPages ?? 1), (int)(ViewBag.CurrentPage ?? 1) + 2); i++)
                        {
                            <li class="page-item @(i == (int)(ViewBag.CurrentPage ?? 1) ? "active" : "")">
                                <a class="page-link" href="?page=@i">@i</a>
                            </li>
                        }

                        @if ((int)(ViewBag.CurrentPage ?? 1) < (int)(ViewBag.TotalPages ?? 1))
                        {
                            <li class="page-item">
                                <a class="page-link" href="?page=@(ViewBag.CurrentPage + 1)" aria-label="Next">
                                    <i class="bi bi-chevron-double-right"></i>
                                </a>
                            </li>
                        }
                        else
                        {
                            <li class="page-item disabled">
                                <span class="page-link" aria-label="Next">
                                    <i class="bi bi-chevron-double-right"></i>
                                </span>
                            </li>
                        }
                    </ul>
                </nav>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4 sidebar-content">
                <div class="admission-menu">
                    <partial name="_AdmissionMenu" />
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function playVideo(videoSrc) {
            if (!videoSrc) {
                alert('Video không khả dụng');
                return;
            }

            // Create video modal
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.9);
                z-index: 9999;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
            `;
            
            const video = document.createElement('video');
            video.src = videoSrc;
            video.controls = true;
            video.autoplay = true;
            video.style.cssText = `
                width: 90%;
                max-width: 800px;
                height: auto;
                max-height: 80vh;
                border-radius: 8px;
                object-fit: contain;
            `;
            
            modal.appendChild(video);
            document.body.appendChild(modal);
            
            // Close modal when clicking outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Close modal with Escape key
            const closeModal = function(e) {
                if (e.key === 'Escape') {
                    document.body.removeChild(modal);
                    document.removeEventListener('keydown', closeModal);
                }
            };
            document.addEventListener('keydown', closeModal);

            // Prevent video click from closing modal
            video.addEventListener('click', function(e) {
                e.stopPropagation();
            });
        }
    </script>
</body>
</html>